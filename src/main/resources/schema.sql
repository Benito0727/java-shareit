DROP TABLE IF EXISTS BOOKING_STATUS CASCADE;
DROP TABLE IF EXISTS BOOKINGS CASCADE;
DROP TABLE IF EXISTS ITEMS CASCADE;
DROP TABLE IF EXISTS USERS CASCADE;


CREATE TABLE IF NOT EXISTS USERS (
user_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
user_name VARCHAR(64) NOT NULL,
user_email VARCHAR(128) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS ITEMS (
item_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
item_name VARCHAR(64) NOT NULL,
item_description VARCHAR(512) NOT NULL,
is_available BOOLEAN,
owner_id BIGINT NOT NULL REFERENCES USERS(user_id) ON UPDATE CASCADE ON DELETE CASCADE,
last_booking_id BIGINT,
next_booking_id BIGINT
);

CREATE TABLE IF NOT EXISTS BOOKINGS (
booking_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
start_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
end_date TIMESTAMP WITHOUT TIME ZONE NOT NULL,
status_id INTEGER NOT NULL,
booker_id BIGINT NOT NULL REFERENCES USERS(user_id) ON UPDATE CASCADE ON DELETE CASCADE,
item_id BIGINT NOT NULL REFERENCES ITEMS(item_id) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS COMMENTS (
comment_id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
content VARCHAR(1024) NOT NULL,
author_id BIGINT NOT NULL REFERENCES USERS(user_id) ON UPDATE CASCADE ON DELETE CASCADE,
created_by TIMESTAMP NOT NULL
)

